{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import React from 'react'\n\nlet browser = window\nlet popup = null\nlet timer = null\n\nfunction watcher() {\n  if (popup === null) {\n    clearInterval(timer)\n    timer = null\n  } else if (popup !== null && !popup.closed) {\n    popup.focus()\n  } else if (popup !== null && popup.closed) {\n    clearInterval(timer)\n    browser.focus()\n    timer = null\n    popup = null\n  }\n}\n\nconst WindowOpener = (props) => {\n  const { children, width, height, className } = props\n  const opts = `dependent=${1}, alwaysOnTop=${1}, alwaysRaised=${1}, alwaysRaised=${1}, width=${\n    width || 300\n  }, height=${height || 400} left=${left} top=${top}`\n  browser = window.self\n  browser.onSuccess = (res) => {\n    props.bridge(null, res)\n  }\n\n  browser.onError = (error) => {\n    props.bridge(error)\n  }\n\n  browser.onOpen = (message) => {\n    props.bridge(null, message)\n  }\n\n  browser.onClose = (message) => {\n    props.bridge(null, message)\n  }\n\n  const onClickHandler = (evt) => {\n    console.log('onClickHandler', props)\n\n    const { url, name } = props\n    if (popup && !popup.closed) {\n      popup.focus()\n\n      return\n    }\n\n    popup = browser.open(url, name, opts)\n\n\n    if (timer === null) {\n      timer = setInterval(watcher, 500)\n    }\n\n    return\n  }\n\n  return <div className = {className} onClick={onClickHandler}>{children}</div>\n}\n\nconst dualScreenLeft =\n  window.screenLeft !== undefined ? window.screenLeft : window.screenX\nconst dualScreenTop =\n  window.screenTop !== undefined ? window.screenTop : window.screenY\n\nconst width = window.innerWidth\n  ? window.innerWidth\n  : document.documentElement.clientWidth\n  ? document.documentElement.clientWidth\n  : screen.width\nconst height = window.innerHeight\n  ? window.innerHeight\n  : document.documentElement.clientHeight\n  ? document.documentElement.clientHeight\n  : screen.height\n\nconst systemZoom = width / window.screen.availWidth\nconst left = (width - 300) / 2 / systemZoom + dualScreenLeft\nconst top = (height - 400) / 2 / systemZoom + dualScreenTop\n\nexport default WindowOpener\n"],"names":["browser","window","popup","timer","watcher","clearInterval","closed","focus","WindowOpener","props","children","width","height","className","opts","left","top","self","onSuccess","res","bridge","onError","error","onOpen","message","onClose","onClickHandler","evt","console","log","url","name","open","setInterval","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","innerWidth","document","documentElement","clientWidth","screen","innerHeight","clientHeight","systemZoom","availWidth"],"mappings":"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"}